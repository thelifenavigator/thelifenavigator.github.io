<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Skilling Performance and AI-Based Future Course Prediction</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* General Styling */
    body {
      font-family: 'Times New Roman', serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
    }

    /* Header styling */
    .header {
      background-color: #0066cc;
      color: #fff;
      padding: 20px;
      text-align: center;
      margin-bottom: 20px;
    }

    .header h1 {
      font-size: 32px;
      font-weight: bold;
    }

    .header img {
      width: 200px;
      height: auto;
    }

    /* Login and result container styling */
    .login-container, .result-container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .result-container {
      display: none;
    }

    /* Login form styling */
    .login-container h2 {
      text-align: center;
      margin-bottom: 20px;
      font-weight: bold;
      font-size: 24px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group input[type="text"] {
      width: 100%;
      padding: 12px;
      font-size: 18px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    .form-group input[type="submit"] {
      width: 100%;
      padding: 14px;
      background-color: #4CAF50;
      color: white;
      border: none;
      font-size: 18px;
      border-radius: 4px;
      cursor: pointer;
    }

    .form-group input[type="submit"]:hover {
      background-color: #45a049;
    }

    .error-message {
      color: #ff6347;
      text-align: center;
      margin-top: 10px;
    }

    /* School image styling */
    .school-image {
      text-align: center;
      margin-bottom: 20px;
    }

    .school-image img {
      width: 350px;
      height: 150px;
      object-fit: contain;
    }

    /* Styling for loading image */
    #loadingImage img {
      width: 350px;
      height: 350px;
 text-align: center;
    }

    /* Chart and result section styling */
    .result-header {
      text-align: center;
      margin-bottom: 20px;
    }

    .result-header h2 {
      font-size: 28px;
      font-weight: bold;
    }

    .result-info {
      text-align: center;
      font-size: 18px;
      margin-bottom: 20px;
    }

    .result-section h3 {
      font-size: 22px;
      margin-top: 20px;
    }

    /* Table Styling */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
      font-size: 18px;
    }

    table, th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: #0073e6;
      color: white;
    }

    td {
      background-color: #f9f9f9;
    }

    /* Chart container */
    .chart-container {
      width: 100%;
      margin-bottom: 30px;
    }

    /* Detailed analysis section */
    .detailed-analysis p {
      font-size: 18px;
    }

    /* Category header styling */
    .category-header {
      font-size: 20px;
      font-weight: bold;
      margin-top: 30px;
    }

    /* Button group styling */
    .btn-group {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .btn {
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      text-decoration: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .btn:hover {
      background-color: #45a049;
    }

    @media (max-width: 600px) {
      .form-group input[type="text"], .form-group input[type="submit"] {
        font-size: 16px;
        padding: 10px;
      }

      table, th, td {
        font-size: 16px;
      }
    }

    /* Enhanced video section styling */
    .video-container {
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    margin-top: 20px;
  }
  
  .video-container {
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    margin-top: 20px;
  }
  
  .video-box {
    width: 45%;
    position: relative;
    padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
    margin: 20px 0;
    border: 2px solid #0073e6;
    background-color: #000;
  }
  
  .video-box h4 {
    position: absolute;
    top: 5px;
    left: 5px;
    color: #ff5722;
    font-size: 1.1em;
    font-weight: bold;
  }

  .video-box iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    padding-top: 30px; /* To ensure title visibility */
  }

    /* Displaying trend section */
    #trendSection {
      margin-top: 30px;
    }


  /* Theater-style video container */
    .theater-video-container {
      border: 5px solid #000;
      border-radius: 20px;
      padding: 10px;
      width: 80%;
      max-width: 720px;
      height: 400px;
      margin: 20px auto;
      background-color: #333;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
    }

    .theater-video-container iframe {
      width: 100%;
      height: 100%;
      border-radius: 10px;
    }

    @keyframes glow {
      from {
        opacity: 0.7;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes blink {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.5;
      }
    }

    .menu-bar {
      display: flex;
      justify-content: center;
      background-color: #0073e6;
      padding: 10px 0;
    }

    .menu-bar a {
      color: white;
      text-decoration: none;
      padding: 10px 15px;
      font-size: 1.2em;
      margin: 0 5px;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    .menu-bar a:hover {
      background-color: #005bb5;
    }

    @media only screen and (max-width: 600px) {
      .header-image {
        width: 90%;
      }

      .welcome-section h1 {
        font-size: 1.8em;
      }

      .school-name {
        font-size: 1.2em;
      }

      .button-section button {
        font-size: 1.1em;
      }

      .reminder-image {
        width: 80%;
        height: auto;
      }

      .theater-video-container {
        width: 90%;
        height: 250px;
      }


  </style>
</head>
<body>

  <div class="header">
    <h1>Skilling Performance and AI-Based Future Course Prediction</h1>
    <img id="schoolHeaderImage" src="https://via.placeholder.com/350x150" alt="School Image">
  </div>

  <!-- Login Form -->
  <div class="login-container">
    <h2>Login</h2>
    <form id="loginForm">
      <div class="form-group">
        <input type="text" id="userId" placeholder="User ID" required>
      </div>
      <div class="form-group">
        <input type="submit" value="Login">
      </div>
      <div id="loadingImage" style="display: none;">
        <img src="https://thelifenavigator.com/wp-content/uploads/2024/09/Motivational-Quote-About-Patience-Instagram-Post-2-1024x1024.gif" alt="Loading...">
      </div>
      <div class="error-message" id="errorMessage"></div>
    </form>
  </div>

  <!-- Result Section -->
  <div class="result-container" id="resultContainer">
    <!-- School Image -->
    <div class="school-image">
      <img id="schoolImage" src="https://via.placeholder.com/350x150" alt="School Image">
    </div>

    <!-- Result Header -->
    <div class="result-header">
      <h2>Skilling Performance and AI-Based Future Course Prediction</h2>
    </div>

    <!-- Student and Parent Information -->
    <div class="result-info" id="studentInfo"></div>

    <!-- Messages from Parents Dashboard -->
    <div class="result-section">
      <h3>Messages from Parents Dashboard</h3>
      <div class="result-info" id="schoolMessage"></div>
      <div class="result-info" id="schoolMessage2"></div>
    </div>

    <!-- Chapter-wise Performance Improvement Graphs -->
    <div class="result-section">
      <h3>Science Chapter-wise Performance</h3>
      <div class="chart-container">
        <canvas id="scienceChapterChart"></canvas>
      </div>

      <h3>Math Chapter-wise Performance</h3>
      <div class="chart-container">
        <canvas id="mathChapterChart"></canvas>
      </div>




      <h3>Science vs Math Chapter-wise Comparison</h3>
      <div class="chart-container">
        <canvas id="comparisonChapterChart"></canvas>
      </div>
    </div>

    <!-- Science and Math Results -->
    <div class="result-section">
      <h3>Science Results</h3>
      <table id="scienceTable"></table>

      <h3>Math Results</h3>
      <table id="mathTable"></table>
    </div>

    <!-- Performance Analysis -->
    <div class="performance-analysis">
      <h3>Performance Analysis for Quarterly, Half Yearly, and Final Exams</h3>
      <div class="chart-container">
        <canvas id="examPerformanceChart"></canvas>
      </div>
    </div>

   <div>
  <h3>Trend</h3>
  <div class="chart-container">
    <canvas id="trendChart"></canvas>
  </div>
  <div id="trendRemarks" class="trend-remarks"></div>
</div>

    <!-- Detailed Analysis -->
    <div class="detailed-analysis">
      <h3>Detailed Analysis</h3>
      <p id="detailedAnalysis"></p>
    </div>

    <!-- Suggested Action Plan -->
    <div class="category-header">
      <h4>Student Performance Analysis and Suggested Action Plan</h4>
      <div>
        <strong>Science Category:</strong> <span id="scienceLearnerCategory"></span>
        <br>
        <strong>Tips to Improve in Science:</strong>
        <p id="scienceTips"></p>
      </div>
      <div>
        <strong>Math Category:</strong> <span id="mathLearnerCategory"></span>
        <br>
        <strong>Tips to Improve in Math:</strong>
        <p id="mathTips"></p>
      </div>
    </div>

    <!-- Buttons for Weak and Bright Learners -->
    <div class="btn-group">
      <a href="weak_learners.html" class="btn">Weak Learners</a>
      <a href="bright_learners.html" class="btn">Bright Learners</a>
    </div>

    <!-- Personality Test and IQ Performance -->
    <div class="category-header">
      <h4>Personality Test Analysis and IQ Performance</h4>
      <p>This section will be added later for detailed analysis of personality and IQ performance.</p>
    </div>

<!-- YouTube Videos Section -->
<div class="video-container">
  <div class="video-box">
    <h4>Plans for Weak Learners</h4>
    <iframe src="https://www.youtube.com/embed/laC6ED-3qRY"
      title="YouTube video player" frameborder="0" 
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
      allowfullscreen></iframe>
  </div>
  
  <div class="video-box">
    <h4>Plans for Bright Learners</h4>
    <iframe src="https://www.youtube.com/embed/NPj_i75OHqs"  
      title="YouTube video player" frameborder="0" 
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
      allowfullscreen></iframe>
  </div>
</div>

 <!-- Separator line  -->
  <div class="blue-line"></div>

<!-- Video title header -->
<h2 id="videoTitleLabel" style="text-align: center; font-size: 1.8em; font-weight: bold; color: #ff5722;">Loading video title...</h2>

<!-- Video container with theater-style border -->
<div class="theater-video-container">
  <iframe id="videoPlayer" src="" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>



  </div>

  <script>
















    // Handle form submission
    document.getElementById('loginForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const userId = document.getElementById('userId').value;
        const errorMessage = document.getElementById('errorMessage');
        const resultContainer = document.getElementById('resultContainer');
        const loadingImage = document.getElementById('loadingImage');

        // Clear previous error message
        errorMessage.textContent = '';

        // Show loading image
        loadingImage.style.display = 'block';

        // Prepare form data for login request
        const formData = new FormData();
        formData.append('userId', userId);

        // Send login request to Google Apps Script endpoint
        fetch('https://script.google.com/macros/s/AKfycbyXsnVI7HNWV7IMrnC724ypj5wfHqGUL1dXMbloXMA2p_r_fJ7R0w02kJY0Ucpx4R4B/exec', {
            method: 'POST',
            body: formData
        })
            .then(response => response.json())
            .then(data => {
    loadingImage.style.display = 'none'; // Hide loading image
    if (data.result === 'success') {
        // Hide login form and show the result container
        document.querySelector('.login-container').style.display = 'none';
        resultContainer.style.display = 'block';

        // Display school image, student details, and school messages
        document.getElementById('schoolImage').src = data.userData.schoolURL;
        document.getElementById('schoolHeaderImage').src = data.userData.schoolURL;
        document.getElementById('studentInfo').textContent = `${data.userData.studentName} | Parent: ${data.userData.parentName} | Class: ${data.userData.studentClass}`;
        document.getElementById('schoolMessage').textContent = data.userData.schoolMessage;
        document.getElementById('schoolMessage2').textContent = data.userData.schoolMessage2;

        // Set the video title and URL
        document.getElementById('videoTitleLabel').textContent = data.userData.videoTitle;
        if (data.userData.videoUrl) {
            document.getElementById('videoPlayer').src = data.userData.videoUrl;
        }

        // Display Science and Math chapter-wise performance charts
        displayChapterPerformanceCharts(data.science.chapterTests, data.math.chapterTests);

        // Display Science and Math results
        displayTable('science', data.science);
        displayTable('math', data.math);

        // Display Quarterly, Half Yearly, and Final Exam performance chart
        displayExamPerformanceChart(data.science, data.math);

        // Display Suggested Action Plan (Separate categories for Science and Math)
        displayActionPlan(data.science, data.math);
    } else {
        // Display error message
        errorMessage.textContent = 'Invalid User ID.';
    }
})
            .catch(error => {
                loadingImage.style.display = 'none'; // Hide loading image
                errorMessage.textContent = 'Error logging in. Please try again.';
            });
    });

    // Function to display user data (from localStorage)
    function displayUserData() {
        document.getElementById('commentTitleLabel').textContent = localStorage.getItem('commentTitle') || 'Loading comment title...';
        document.getElementById('commentBox').value = localStorage.getItem('commentBox') || '';
    }

    // Call the display function on page load
    window.onload = function () {
        displayUserData();
    };



    // Fixed displayUserData function for pulling data from localStorage and setting video data
    function displayUserData() {
        const parentName = localStorage.getItem('parentName');
        const schoolName = localStorage.getItem('schoolName');
        const schoolURL = localStorage.getItem('schoolURL');
        const schoolMessage1 = localStorage.getItem('schoolMessage') || 'Loading message...';
        const schoolMessage2 = localStorage.getItem('schoolMessage2') || 'Loading second message...';
        const quoteHeader = localStorage.getItem('quoteHeader') || 'Loading...';
        const quoteUrl = localStorage.getItem('quoteUrl');
        const videoTitle = localStorage.getItem('videoTitle') || 'Loading video title...'; // Video title from S column
        const videoUrl = localStorage.getItem('videoUrl') || ''; // YouTube link from T column

        // Set the video title and embed YouTube video
        document.getElementById('videoTitleLabel').textContent = videoTitle;
        if (videoUrl) {
            document.getElementById('videoPlayer').src = videoUrl;
        }
    }

    // Call this function on page load
    window.onload = function () {
        displayUserData();
    };






    // Function to display chapter-wise performance charts
    function displayChapterPerformanceCharts(scienceTests, mathTests) {
      const scienceMarks = scienceTests.map(test => test.marksObtained);
      const mathMarks = mathTests.map(test => test.marksObtained);
      const testNames = scienceTests.map(test => test.testName);

      // Science Chapter-wise Performance Bar Chart
      const scienceCtx = document.getElementById('scienceChapterChart').getContext('2d');
      new Chart(scienceCtx, {
        type: 'bar',
        data: {
          labels: testNames,
          datasets: [{
            label: 'Science Chapter Performance',
            data: scienceMarks,
            backgroundColor: '#4CAF50'
          }]
        },
        options: {
          responsive: true,
          title: {
            display: true,
            text: 'Science Chapter-wise Performance'
          }
        }
      });

      // Math Chapter-wise Performance Bar Chart
      const mathCtx = document.getElementById('mathChapterChart').getContext('2d');
      new Chart(mathCtx, {
        type: 'bar',
        data: {
          labels: testNames,
          datasets: [{
            label: 'Math Chapter Performance',
            data: mathMarks,
            backgroundColor: '#FF9800'
          }]
        },
        options: {
          responsive: true,
          title: {
            display: true,
            text: 'Math Chapter-wise Performance'
          }
        }
      });

      // Science vs Math Chapter-wise Comparison Bar Chart
      const comparisonCtx = document.getElementById('comparisonChapterChart').getContext('2d');
      new Chart(comparisonCtx, {
        type: 'bar',
        data: {
          labels: testNames,
          datasets: [
            {
              label: 'Science',
              data: scienceMarks,
              backgroundColor: '#4CAF50'
            },
            {
              label: 'Math',
              data: mathMarks,
              backgroundColor: '#FF9800'
            }
          ]
        },
        options: {
          responsive: true,
          title: {
            display: true,
            text: 'Science vs Math Chapter-wise Performance'
          }
        }
      });
    }

    // Function to display Science and Math tables
    function displayTable(subject, data) {
      let table = `<thead><tr><th>Test Name</th><th>Total Marks</th><th>Marks Obtained</th></tr></thead><tbody>`;

      data.chapterTests.forEach(test => {
        table += `<tr><td>${test.testName}</td><td>${test.totalMarks}</td><td>${test.marksObtained}</td></tr>`;
      });

      if (data.chapterTests.length === 0) {
        table += `<tr><td colspan="3">No chapter tests taken yet</td></tr>`;
      }

      table += `<tr><td><strong>Average of Chapter Tests</strong></td><td colspan="2">${data.chapterAverage}</td></tr>`;
      table += `<tr><td>Quarterly Exam</td><td>${data.quarterlyExam.totalMarks}</td><td>${data.quarterlyExam.marksObtained || 'Not yet taken'}</td></tr>`;
      table += `<tr><td>Half Yearly Exam</td><td>${data.halfYearlyExam.totalMarks}</td><td>${data.halfYearlyExam.marksObtained || 'Not yet taken'}</td></tr>`;
      table += `<tr><td>Final Exam</td><td>${data.finalExam.totalMarks}</td><td>${data.finalExam.marksObtained || 'Not yet taken'}</td></tr>`;

      let totalExamMarks = 0;
      let examsTaken = 0;

      if (data.quarterlyExam.marksObtained) {
        totalExamMarks += parseFloat(data.quarterlyExam.marksObtained);
        examsTaken++;
      }
      if (data.halfYearlyExam.marksObtained) {
        totalExamMarks += parseFloat(data.halfYearlyExam.marksObtained);
        examsTaken++;
      }
      if (data.finalExam.marksObtained) {
        totalExamMarks += parseFloat(data.finalExam.marksObtained);
        examsTaken++;
      }

      const examAverage = examsTaken > 0 ? (totalExamMarks / examsTaken).toFixed(2) : 'No exams taken';
      table += `<tr><td><strong>Average of Quarterly + Half Yearly + Final</strong></td><td colspan="2">${examAverage}</td></tr>`;
      const totalMarks = examsTaken > 0 ? (parseFloat(data.chapterAverage) + parseFloat(examAverage)).toFixed(2) : data.chapterAverage;
      table += `<tr><td><strong>Total Marks</strong></td><td colspan="2">${totalMarks}</td></tr>`;
      table += `</tbody>`;

      document.getElementById(`${subject}Table`).innerHTML = table;
    }

    // Function to display Quarterly, Half Yearly, and Final Exam Performance
    function displayExamPerformanceChart(science, math) {
      const ctx = document.getElementById('examPerformanceChart').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Quarterly', 'Half Yearly', 'Final'],
          datasets: [
            {
              label: 'Science',
              data: [science.quarterlyExam.marksObtained || 0, science.halfYearlyExam.marksObtained || 0, science.finalExam.marksObtained || 0],
              backgroundColor: '#4CAF50'
            },
            {
              label: 'Math',
              data: [math.quarterlyExam.marksObtained || 0, math.halfYearlyExam.marksObtained || 0, math.finalExam.marksObtained || 0],
              backgroundColor: '#FF9800'
            }
          ]
        },
        options: {
          responsive: true,
          title: {
            display: true,
            text: 'Quarterly, Half Yearly, and Final Exam Performance'
          }
        }
      });
    }





  function displayTrendChart(scienceScores, mathScores, labels) {
    // Filter out exams not taken
    const validLabels = [];
    const validScienceScores = [];
    const validMathScores = [];

    for (let i = 0; i < labels.length; i++) {
      if (scienceScores[i] !== null || mathScores[i] !== null) {
        validLabels.push(labels[i]);
        validScienceScores.push(scienceScores[i] !== null ? scienceScores[i] : 0); // Set to 0 if null
        validMathScores.push(mathScores[i] !== null ? mathScores[i] : 0); // Set to 0 if null
      }
    }

    const ctx = document.getElementById('trendChart').getContext('2d');

    new Chart(ctx, {
      type: 'bar',  // Changed from 'line' to 'bar'
      data: {
        labels: validLabels, // Filtered labels (e.g., ['Chapter Tests', 'Quarterly'])
        datasets: [
          {
            label: 'Science',
            data: validScienceScores, // Filtered science scores
            backgroundColor: 'rgba(75, 192, 192, 0.8)', // Updated color
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1,
          },
          {
            label: 'Math',
            data: validMathScores, // Filtered math scores
            backgroundColor: 'rgba(255, 99, 132, 0.8)', // Updated color
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 1,
          },
        ],
      },
      options: {
        scales: {
          y: {
            beginAtZero: true, // Ensure the Y-axis starts at 0
            ticks: {
              stepSize: 5, // Optional: Adjust step size
            }
          },
        },
        responsive: true,
        plugins: {
          legend: {
            display: true,
          },
          title: {
            display: true,
            text: 'Performance Trend (Bar Chart)',
          },
        },
      },
    });
  }

  // Example usage:

  // Assuming 'null' means the exam was not taken
  const scienceTrendScores = [18, null, null, null];  // Science score with only chapter test taken
  const mathTrendScores = [19, null, null, null];     // Math score with only chapter test taken
  const trendLabels = ['Chapter Tests', 'Quarterly', 'Half Yearly', 'Final'];

  // Invoke the function to display the chart
  displayTrendChart(scienceTrendScores, mathTrendScores, trendLabels);






function displayTrendRemarks(scienceScores, mathScores) {
  const trendRemarksDiv = document.getElementById('trendRemarks');
  let remarks = '';

  // Check if exams were not taken
  if (scienceScores.includes(null) || mathScores.includes(null)) {
    remarks += 'Note: Some exams (Quarterly, Half Yearly, Final) were not taken, trend analysis is based on available data.<br>';
  }

  // Add usual remarks logic for performance
  const scienceImprovement = scienceScores[scienceScores.length - 1] > scienceScores[0];
  const mathImprovement = mathScores[mathScores.length - 1] > mathScores[0];

  if (scienceImprovement) {
    remarks += 'Science Performance: Improvement observed.<br>';
  } else {
    remarks += 'Science Performance: No improvement, consider revising key concepts.<br>';
  }

  if (mathImprovement) {
    remarks += 'Math Performance: Improvement observed.<br>';
  } else {
    remarks += 'Math Performance: No improvement, additional practice recommended.<br>';
  }

  trendRemarksDiv.innerHTML = remarks;
}

// Example usage
displayTrendRemarks(scienceTrendScores, mathTrendScores);







    
  function displayActionPlan(science, math) {
    let scienceCategory;
    let mathCategory;
    let scienceTips = '';
    let mathTips = '';
    let scienceFinalPercentage = 0;
    let mathFinalPercentage = 0;

    // Helper function to calculate exam average if they exist
    function calculateExamAverage(exam1, exam2, exam3) {
        const exams = [exam1, exam2, exam3].filter(exam => exam.marksObtained != null && exam.marksObtained !== 'Not yet taken');
        return exams.length > 0
            ? exams.reduce((total, exam) => total + exam.marksObtained, 0) / exams.length
            : null;
    }

    // --- Science ---
    const scienceExamsAverage = calculateExamAverage(science.quarterlyExam, science.halfYearlyExam, science.finalExam);

    if (scienceExamsAverage === null || scienceExamsAverage === 0) {
        // Case 1: Only chapter tests taken (or no exams at all)
        if (science.chapterAverage > 0) {
            scienceFinalPercentage = (science.chapterAverage / 20) * 100; // Use total marks as 20 for chapter tests
            console.log("Science: Only chapter tests taken, percentage = " + scienceFinalPercentage);
        } else {
            // No chapter tests taken either
            document.getElementById('detailedAnalysis').innerHTML = `
                <strong>No tests or exams taken for Science.</strong>
                <br>Please attempt chapter tests or exams and return for analysis.
            `;
            return; // Exit the function since no data is available for Science
        }
    } else {
        // Case 2: Both chapter tests and other exams taken
        scienceFinalPercentage = ((science.chapterAverage + scienceExamsAverage) / 100) * 100; // Use total marks as 100
        console.log("Science: Chapter tests + exams taken, percentage = " + scienceFinalPercentage);
    }

    // --- Math ---
    const mathExamsAverage = calculateExamAverage(math.quarterlyExam, math.halfYearlyExam, math.finalExam);

    if (mathExamsAverage === null || mathExamsAverage === 0) {
        // Case 1: Only chapter tests taken (or no exams at all)
        if (math.chapterAverage > 0) {
            mathFinalPercentage = (math.chapterAverage / 20) * 100; // Use total marks as 20 for chapter tests
            console.log("Math: Only chapter tests taken, percentage = " + mathFinalPercentage);
        } else {
            // No chapter tests taken either
            document.getElementById('detailedAnalysis').innerHTML = `
                <strong>No tests or exams taken for Math.</strong>
                <br>Please attempt chapter tests or exams and return for analysis.
            `;
            return; // Exit the function since no data is available for Math
        }
    } else {
        // Case 2: Both chapter tests and other exams taken
        mathFinalPercentage = ((math.chapterAverage + mathExamsAverage) / 100) * 100; // Use total marks as 100
        console.log("Math: Chapter tests + exams taken, percentage = " + mathFinalPercentage);
    }

    // --- Categorize Learners Based on Performance ---
    // Science Learner Category
    if (scienceFinalPercentage < 50) {
        scienceCategory = 'Weak Learner in Science';
        scienceTips = 'Focus on foundational concepts, use interactive experiments, and ensure regular practice in Science topics.';
    } else if (scienceFinalPercentage >= 50 && scienceFinalPercentage < 75) {
        scienceCategory = 'Moderate Learner in Science';
        scienceTips = 'Encourage deeper understanding of Science concepts through problem-solving and relating them to real-world applications.';
    } else {
        scienceCategory = 'Bright Learner in Science';
        scienceTips = 'Challenge yourself with advanced science projects and participate in science fairs to further improve skills.';
    }

    // Math Learner Category
    if (mathFinalPercentage < 50) {
        mathCategory = 'Weak Learner in Math';
        mathTips = 'Use visual aids like graphs, practice mental math regularly, and focus on breaking down complex problems into smaller steps.';
    } else if (mathFinalPercentage >= 50 && mathFinalPercentage < 75) {
        mathCategory = 'Moderate Learner in Math';
        mathTips = 'Work on practicing problem-solving techniques and focus on areas that require improvement to boost your confidence in Math.';
    } else {
        mathCategory = 'Bright Learner in Math';
        mathTips = 'Take on more challenging problems and explore advanced mathematical theories to enhance your Math skills.';
    }

    // --- Display the Percentages and Categories ---
    document.getElementById('scienceLearnerCategory').innerHTML = `Category: ${scienceCategory} (Percentage: ${scienceFinalPercentage.toFixed(2)}%)`;
    document.getElementById('mathLearnerCategory').innerHTML = `Category: ${mathCategory} (Percentage: ${mathFinalPercentage.toFixed(2)}%)`;
    document.getElementById('scienceTips').innerHTML = scienceTips;
    document.getElementById('mathTips').innerHTML = mathTips;

    // --- Display Detailed Guidelines, Remedies, Dos, and Don'ts ---
    let performanceRecommendation = '';
    if (mathFinalPercentage > scienceFinalPercentage) {
        performanceRecommendation = 'The student shows more aptitude for Math-related courses like Engineering.';
    } else if (scienceFinalPercentage > mathFinalPercentage) {
        performanceRecommendation = 'The student shows more aptitude for Science-related courses like Medical.';
    } else {
        performanceRecommendation = 'The student demonstrates balanced performance in both Science and Math.';
    }

    const analysis = `
        <strong>Detailed Analysis:</strong>
        Based on your performance in Science and Math, your chances of success in:
        <ul>
            <li><strong>Engineering (Math-related courses)</strong>: ${mathFinalPercentage > 60 ? 'Good' : 'Needs Improvement'} based on your overall Math performance.</li>
            <li><strong>Medical (Science-related courses)</strong>: ${scienceFinalPercentage > 60 ? 'Good' : 'Needs Improvement'} based on your overall Science performance.</li>
        </ul>
        ${performanceRecommendation}
        <br><br>
        <strong>General Remedies and Tips:</strong>
        <ul>
            <li>Stay consistent with daily practice in both subjects to strengthen your foundational skills.</li>
            <li>Engage with interactive tools like online quizzes or practical activities to enhance understanding.</li>
            <li>For improvement, focus on areas where marks are consistently low and consult your teachers regularly for feedback.</li>
        </ul>
    `;
    document.getElementById('detailedAnalysis').innerHTML = analysis;
}


 </script>
</body>
</html>
